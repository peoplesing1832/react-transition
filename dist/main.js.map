{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./node_modules/@babel/runtime/helpers/interopRequireDefault.js","webpack:///./node_modules/@babel/runtime/helpers/interopRequireWildcard.js","webpack:///external {\"root\":\"React\",\"commonjs2\":\"react\",\"commonjs\":\"react\",\"amd\":\"react\"}","webpack:///./node_modules/@babel/runtime/helpers/slicedToArray.js","webpack:///./node_modules/@babel/runtime/helpers/defineProperty.js","webpack:///./src/v3/Transition.tsx","webpack:///./node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/arrayLikeToArray.js","webpack:///./src/v3/Transitions.tsx","webpack:///./src/index.ts","webpack:///./src/v3/Flip.tsx","webpack:///./node_modules/@babel/runtime/helpers/typeof.js","webpack:///./node_modules/@babel/runtime/helpers/arrayWithHoles.js","webpack:///./node_modules/@babel/runtime/helpers/iterableToArrayLimit.js","webpack:///./node_modules/@babel/runtime/helpers/nonIterableRest.js","webpack:///./node_modules/@babel/runtime/helpers/toConsumableArray.js","webpack:///./node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","webpack:///./node_modules/@babel/runtime/helpers/iterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/nonIterableSpread.js","webpack:///./src/util/uuid.ts","webpack:///./src/v3/Flips.tsx","webpack:///./src/v3/Observer.tsx"],"names":["root","factory","exports","module","require","define","amd","window","__WEBPACK_EXTERNAL_MODULE__2__","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","obj","_typeof","_getRequireWildcardCache","WeakMap","cache","has","newObj","hasPropertyDescriptor","getOwnPropertyDescriptor","desc","set","arrayWithHoles","iterableToArrayLimit","unsupportedIterableToArray","nonIterableRest","arr","configurable","writable","STATUS","noop","props","duration","delay","animation","unmount","onUnmounted","onEntered","onEntering","onLeaveed","onLeaveing","leaveDisplayNone","appear","children","useState","_animation","setAnimation","status","setStatus","interval","setIntervalTime","firstMount","useRef","prevClassNames","className","prevStyle","style","id","timers","Set","rAF","requestAnimationFrame","useContext","TransitionsContext","prefix","animations","collection","waitForTransitionStart","callback","setTimeout","waitTransition","useEffect","current","forEach","timer","clearTimeout","clear","transitionDelay","add","_onLeaveed","handleLeaveed","transitionDuration","leave","handleLeaveing","handleEntered","enter","handleEntering","currentId","push","useMemo","classPrefix","nextStyle","display","nextClassName","React","cloneElement","Children","only","arrayLikeToArray","minLen","toString","slice","constructor","Array","from","test","len","length","arr2","createContext","masterSwitch","setAnimations","_collection","ids","reverse","counter","Provider","inOutDuration","_inOutDuration","_name","child","iterator","isArray","_arr","_n","_d","_e","undefined","_s","_i","next","done","err","TypeError","arrayWithoutHoles","iterableToArray","nonIterableSpread","iter","buf","Uint32Array","crypto","getRandomValues","idx","replace","getElementByFlipIdAll","parent","querySelectorAll","Flips","wrap","wrapClass","_children","_reflowRef","parentRef","prevRectsRef","reflow","useCallback","document","body","offsetHeight","relativeRect","parentRect","getBoundingClientRect","rect","x","y","addClass","ele","trim","classList","removeClass","remove","removeAttribute","handleLeave","setChildren","prevChildren","getMap","map","isValidElement","nextChildren","prevChildrenMap","nextChildrenMap","prev","getValueForKey","nextKeysPending","pendingKeys","prevKey","childMapping","nextKey","pendingNextKey","mergeMap","keys","hasKeyByNew","hasKeyByPrev","isNew","isDelete","isNeverChange","prevProps","initChildren","useLayoutEffect","console","log","tasks","flipEles","moveClass","nextRects","flipEle","flipId","dataset","nextRect","prevRect","transform","webkitTransform","addEventListener","cb","e","target","propertyName","removeEventListener","task","ChildNode","values","WrapChildNode","createElement","ref","temp","force","memo"],"mappings":"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","file":"main.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"react\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"react\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"react-flip-transition\"] = factory(require(\"react\"));\n\telse\n\t\troot[\"react-flip-transition\"] = factory(root[\"React\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__2__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 9);\n","function _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nmodule.exports = _interopRequireDefault;","var _typeof = require(\"@babel/runtime/helpers/typeof\");\n\nfunction _getRequireWildcardCache() {\n  if (typeof WeakMap !== \"function\") return null;\n  var cache = new WeakMap();\n\n  _getRequireWildcardCache = function _getRequireWildcardCache() {\n    return cache;\n  };\n\n  return cache;\n}\n\nfunction _interopRequireWildcard(obj) {\n  if (obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || _typeof(obj) !== \"object\" && typeof obj !== \"function\") {\n    return {\n      \"default\": obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache();\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj[\"default\"] = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nmodule.exports = _interopRequireWildcard;","module.exports = __WEBPACK_EXTERNAL_MODULE__2__;","var arrayWithHoles = require(\"./arrayWithHoles\");\n\nvar iterableToArrayLimit = require(\"./iterableToArrayLimit\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableRest = require(\"./nonIterableRest\");\n\nfunction _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}\n\nmodule.exports = _slicedToArray;","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","import React, {\n  useState,\n  useEffect,\n  useMemo,\n  useRef,\n  useContext,\n} from 'react';\nimport { TransitionsContext } from './Transitions';\nimport uuid from '../util/uuid';\n\n// unmounted -> leaveed -> entering -> entered -> leaveing -> leaveed -> unmounted\n// unmounted组件卸载状态\nconst noop = () => {};\n\nexport enum STATUS {\n  UNMOUNTED = 'unmounted', // 卸载\n  ENTERED = 'entered', // 显示状态\n  ENTERING = 'entering', // 进入时的状态，从LEAVEED态过渡到ENTERED态\n  LEAVEED = 'leaveed', // 离开状态\n  LEAVEING = 'leaveing', // 离开时的状态，从ENTERED态过渡LEAVEED态\n};\n\nexport type TransitionDuration = {\n  enter: number; // entering的过渡时间\n  leave: number; // leaveing的过渡时间\n};\n\nexport interface TransitionProps {\n  name?: string; // 过渡类的前缀\n  duration?: number | TransitionDuration; // 状态的过渡时间\n  delay?: number; // 延迟时间，进入entering，leaveing前的时间\n  animation?: boolean; // 过渡的开关\n  unmount?: boolean; // 是否在leaveed态之后卸载组件\n  onUnmounted?: () => void; // 卸载组件时的事件\n  onEntered?: () => void; // 进入entered时的事件\n  onEntering?: () => void; // 进入entering时的事件\n  onLeaveed?: () => void; // 进入leaveed时的事件\n  onLeaveing?: () => void; // 进入leaveing时的事件\n  // display的开关，直接在样式中设置display可能会造成过渡失败\n  // 开始display后，LEAVEED时会添加display: none的style\n  leaveDisplayNone?: boolean;\n  children: React.ReactElement;\n  appear?: boolean;\n};\n\ntype waitForTransitionStartCallback = (...args: any[]) => any;\n\nconst durationDefaults = 200;\nconst delayDefaults = 0;\n\nconst Transition: React.FC<TransitionProps> = (props) => {\n  const {\n    name = 'r',\n    duration = durationDefaults,\n    delay = delayDefaults,\n    animation = false,\n    unmount = false,\n    onUnmounted = noop,\n    onEntered = noop,\n    onEntering = noop,\n    onLeaveed = noop,\n    onLeaveing = noop,\n    leaveDisplayNone = false,\n    appear = false,\n    children,\n  } = props;\n\n  // 动画的开关\n  const [_animation, setAnimation] = useState<boolean>(animation);\n  // 动画的状态\n  const [status, setStatus] = useState<STATUS>(() => {\n    if (_animation) {\n      if (appear) {\n        return STATUS['ENTERED'];\n      } else {\n        return STATUS['LEAVEED'];\n      }\n    } else {\n      if (unmount) {\n        return STATUS['UNMOUNTED'];\n      } else {\n        return STATUS['LEAVEED'];\n      }\n    }\n  });\n  // 间隔渲染，主要用在一组动画中，默认为0\n  const [interval, setIntervalTime] = useState<number>(0);\n  // 是否为初次渲染\n  const firstMount = useRef(true);\n  // 最初元素的classNames\n  const prevClassNames = useRef(children.props.className || '');\n  // 最初元素的styles\n  const prevStyle = useRef(children.props.style || '');\n  // 当前动画组件的唯一id\n  const id = useRef(uuid());\n  const timers = useRef(new Set<NodeJS.Timeout>([]));\n  const rAF = typeof window !== 'undefined' && window.requestAnimationFrame;\n  const {\n    prefix,\n    animations,\n    collection,\n  } = useContext(TransitionsContext);\n\n  /**\n   * 等待浏览器渲染完成\n   */\n  const waitForTransitionStart = rAF ? (callback: waitForTransitionStartCallback) => {\n    rAF(() => {\n      rAF(callback);\n    })\n  } : (callback: waitForTransitionStartCallback) => {\n    setTimeout(callback, 50);\n  };\n\n  /**\n   * 等待动画过渡完成后，执行回调\n   */\n  const waitTransition = (\n    duration: number,\n    callback: waitForTransitionStartCallback\n  ) => {\n    const timer = setTimeout(callback, duration);\n    return timer;\n  };\n\n  /**\n   * 处理STATUS['UNMOUNTED']状态\n   */\n  const handleUnmounted = () => {\n    if (!firstMount.current) {\n      // 初次渲染时不触发onUnmounted钩子\n      onUnmounted();\n    }\n    if (_animation) {\n      // 如果是STATUS['UNMOUNTED']状态，并且animation为true。\n      // 我们需要先将状态设置为STATUS['LEAVEED']态\n      setStatus(STATUS['LEAVEED']);\n    } else {\n    }\n  };\n\n  /**\n   * 处理STATUS['LEAVEED']状态\n   */\n  const handleLeaveed = () => {\n    if (_animation) {\n      // 如果开关为开，当前是STATUS['LEAVEED']态，我们下一步需要进入到STATUS['ENTERING']态\n      // 使用waitForTransitionStart，等待浏览器渲染完成\n      waitForTransitionStart(() => {\n        // 如果有延迟，需要等待延迟进入ENTERING态\n        let transitionDelay = delay;\n        transitionDelay += interval;\n        const timer = waitTransition(transitionDelay, () => {\n          setStatus(STATUS['ENTERING']);\n        });\n        timers.current.add(timer);\n      });\n    } else {\n      // 触发leaveed的钩子，只有在真正离开的状态才触发，unmounted -> leaveed状态时不触发\n      onLeaveed()\n      // Observer注入的监听事件\n      const { _onLeaveed } = props as any;\n      if (_onLeaveed) {\n        _onLeaveed();\n      }\n      // 如果开关为关。并且unmount设置为true，需要将状态设置为STATUS['UNMOUNTED']\n      if (unmount) {\n        setStatus(STATUS['UNMOUNTED']);\n      }\n    }\n  };\n\n  /**\n   * 处理STATUS['LEAVEING']状态\n   */\n  const handleLeaveing = () => {\n    // 触发leaveing钩子\n    onLeaveing();\n    if (_animation) {\n      // 如果开关为开，下一步需要过渡到STATUS['ENTERING']状态\n      let transitionDelay = delay;\n      transitionDelay += interval;\n      const timer = waitTransition(transitionDelay, () => {\n        setStatus(STATUS['ENTERING']);\n      });\n      timers.current.add(timer);\n    } else {\n      // 如果开关为关，下一步需要进入等待过渡完成后进入，STATUS['LEAVEED']状态\n      let transitionDuration = typeof duration === 'number' ? duration : duration.leave;\n      const timer = waitTransition(transitionDuration, () => {\n        setStatus(STATUS['LEAVEED']);\n      });\n      timers.current.add(timer);\n    }\n  };\n\n  /**\n   * 处理STATUS['ENTERED']状态\n   */\n  const handleEntered = () => {\n    // 触发onEntered的钩子\n    onEntered();\n    if (_animation) {\n      // 如果开关为开，不处理\n    } else {\n      // 如果开关为关，需要进入到['LEAVEING']状态\n      let transitionDelay = delay;\n      transitionDelay += interval;\n      const timer = waitTransition(transitionDelay, () => {\n        setStatus(STATUS['LEAVEING']);\n      });\n      timers.current.add(timer);\n    }\n  };\n\n  /**\n   * 处理STATUS['ENTERING']状态\n   */\n  const handleEntering = () => {\n    // 触发onEntering钩子\n    onEntering();\n    if (_animation) {\n      // 如果动画开关为开，等待过渡完成后进入STATUS['ENTERED']状态\n      let transitionDuration = typeof duration === 'number' ? duration : duration.enter;\n      const timer = waitTransition(transitionDuration, () => {\n        setStatus(STATUS['ENTERED']);\n      });\n      timers.current.add(timer);\n    } else {\n      // 如果动画开关为关，需要进入到STATUS['LEAVEING']\n      let transitionDelay = delay;\n      transitionDelay += interval;\n      const timer = waitTransition(transitionDelay, () => {\n        setStatus(STATUS['LEAVEING']);\n      });\n      timers.current.add(timer);\n    }\n  };\n\n  useEffect(() => {\n    timers.current.forEach((timer) => {\n      clearTimeout(timer);\n    });\n    timers.current.clear();\n    switch (status) {\n      case STATUS['UNMOUNTED']:\n        handleUnmounted();\n        break;\n      case STATUS['LEAVEED']:\n        handleLeaveed();\n        break;\n      case STATUS['LEAVEING']:\n        handleLeaveing();\n        break;\n      case STATUS['ENTERED']:\n        handleEntered();\n        break;\n      case STATUS['ENTERING']:\n        handleEntering();\n        break;\n    }\n    // 标记为不是初次渲染\n    firstMount.current = false;\n  }, [status, _animation]);\n\n  useEffect(() => {\n    const currentId = id.current;\n    if (animations[currentId]) {\n      const {\n        animation,\n        delay,\n      } = animations[currentId];\n      setIntervalTime(delay);\n      setAnimation(animation);\n    }\n  }, [animations]);\n\n  useEffect(() => {\n    setAnimation(animation);\n  }, [animation]);\n\n\n  useEffect(() => {\n    if (collection) {\n      collection.push(id.current);\n    }\n  }, []);\n\n  const className = useMemo(() => {\n    const classPrefix = prefix ? prefix : name;\n    switch (status) {\n      case STATUS['LEAVEED']:\n        return `${classPrefix}-leaveed`;\n      case STATUS['LEAVEING']:\n        return `${classPrefix}-leaveing`;\n      case STATUS['ENTERED']:\n        return `${classPrefix}-entered`;\n      case STATUS['ENTERING']:\n        return `${classPrefix}-entering`;\n    }\n  }, [status, prefix, name]);\n\n  const nextStyle = useMemo(() => {\n    if (status === STATUS['LEAVEED'] && leaveDisplayNone && !_animation) {\n      return {\n        display: 'none',\n      };\n    }\n    return null;\n  }, [leaveDisplayNone, status, _animation]);\n\n  if (status === STATUS['UNMOUNTED']) {\n    return null;\n  }\n\n  const nextClassName = prevClassNames.current ?\n    `${className} ${prevClassNames.current}`\n    : `${className}`;\n\n  return React.cloneElement(React.Children.only(children), {\n    className: nextClassName,\n    style: {\n      ...prevStyle.current,\n      ...nextStyle,\n    },\n  });\n};\n\nexport default Transition;\n","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;","function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;","// Thank you https://github.com/reactjs/react-transition-group/blob/master/src/utils/ChildMapping.js\nimport React, {\n  useEffect,\n  useState,\n  useRef,\n} from 'react';\n\nexport interface TransitionsProps {\n  masterSwitch?: boolean; // 统一的动画开关(会对所有children的animation做设置)\n  interval?: number; // 每一个动画之间的时间间隔\n  prefix: string;\n}\n\nexport type Animations = {\n  [key: string]: {\n    delay: number;\n    animation: boolean;\n  },\n};\n\nexport const TransitionsContext = React.createContext<{\n  animations: Animations,\n  collection: string[];\n  prefix: string;\n}>({\n  animations: {},\n  collection: [],\n  prefix: '',\n});\n\nconst Transitions: React.FC<TransitionsProps> = (props) => {\n  const {\n    masterSwitch = false,\n    interval = 200,\n    prefix = '',\n    children,\n  } = props;\n\n  const [animations, setAnimations] = useState<Animations>({});\n  const collection = useRef<string[]>([]);\n\n  useEffect(() => {\n    const _collection = [...collection.current];\n    const ids = masterSwitch ? _collection : _collection.reverse();\n    const animations: Animations = {};\n    let counter = 0;\n    ids.forEach((id) => {\n      animations[id] = {\n        delay: counter * interval,\n        animation: masterSwitch,\n      };\n      counter += 1;\n    });\n    setAnimations(animations);\n  }, [masterSwitch, interval]);\n\n  return (\n    <TransitionsContext.Provider value={{\n      animations,\n      collection: collection.current,\n      prefix,\n    }}>\n      { children }\n    </TransitionsContext.Provider>\n  )\n};\n\nexport default Transitions;\n","export { default as Flip } from './v3/Flip';\nexport { default as Flips } from './v3/Flips';\nexport { default as Observer } from './v3/Observer';\nexport { default as Transition } from './v3/Transition';\nexport { default as Transitions } from './v3/Transitions';\n","import * as React from 'react';\nimport Transition from './Transition';\n\nexport interface FlipProps {\n  children: React.ReactElement;\n}\n\nconst Flip: React.FC<FlipProps> = (props) => {\n  const {\n    children,\n  } = props;\n\n  const {\n    _inOutDuration: inOutDuration, // 离开，进入的过渡时长，需要和class中transtion一致\n    _animation: animation, // 离开，进入动画的开关\n    _onLeaveed: onLeaveed,\n    _name: name, // class的前缀\n  } = props as any;\n\n  const child = React.cloneElement(React.Children.only(children));\n\n  return (\n    <Transition\n      name={name}\n      animation={animation}\n      onLeaveed={onLeaveed}\n      duration={inOutDuration}\n      unmount={true}\n    >\n      { child }\n    </Transition>\n  );\n};\n\nexport default Flip;\n","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    module.exports = _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    module.exports = _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nmodule.exports = _typeof;","function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nmodule.exports = _arrayWithHoles;","function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nmodule.exports = _iterableToArrayLimit;","function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableRest;","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\n\nmodule.exports = _arrayWithoutHoles;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableSpread;","// https://stackoverflow.com/questions/105034/how-to-create-guid-uuid\nconst uuid = (): string => {\n  const buf = new Uint32Array(4);\n  window.crypto.getRandomValues(buf);\n  let idx = -1;\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n    idx++;\n    const r = (buf[idx>>3] >> ((idx%8)*4))&15;\n    const v = c == 'x' ? r : (r&0x3|0x8);\n    return v.toString(16);\n  });\n}\n\nexport default uuid;\n","import * as React from 'react';\nimport {\n  useState,\n  useRef,\n  useEffect,\n  useCallback,\n  useLayoutEffect,\n} from 'react';\nimport {\n  ChildrenMap,\n} from './Observer';\n\ninterface FlipsProps {\n  wrap?: string; // 是否添加一层包裹\n  wrapClass?: string; // 包裹的class名称\n  name?: string; // 添加类名的前缀\n  children?: React.ReactNode\n}\n\nconst getElementByFlipIdAll = (parent: HTMLElement) => {\n  return parent.querySelectorAll(`[data-flip-id]`);\n};\n\nconst Flips: React.FC<FlipsProps> = (props) => {\n  const {\n    wrap = 'div',\n    wrapClass = '',\n    name = 'r',\n    children: _children,\n  } = props;\n\n  const _reflowRef = useRef<number>();\n  const parentRef = useRef<HTMLElement>();\n  const firstMount = useRef<boolean>(true);\n  const prevRectsRef = useRef<{[key: string]: DOMRect}>();\n  const move = useRef<{[key: string]: boolean}>({});\n\n  // 强制重绘\n  const reflow = useCallback(() => {\n    _reflowRef.current = document.body.offsetHeight;\n  }, []);\n\n  const relativeRect = useCallback((parent: HTMLElement, child: HTMLElement): DOMRect => {\n    reflow();\n    const parentRect = parent.getBoundingClientRect();\n    let rect = child.getBoundingClientRect();\n    rect.x = parentRect.x - rect.x;\n    rect.y = parentRect.y - rect.y;\n    return rect;\n  }, []);\n\n  // 添加类名\n  const addClass = useCallback((ele: HTMLElement, className: string): void => {\n    if (!className || !(className = className.trim())) {\n      return;\n    }\n    ele.classList.add(className);\n  }, []);\n\n  // 删除类名\n  const removeClass = useCallback((ele: HTMLElement, className: string): void => {\n    if (!className || !(className = className.trim())) {\n      return;\n    }\n    ele.classList.remove(className);\n    if (!ele.classList.length) {\n      ele.removeAttribute('class');\n    }\n  }, []);\n\n  // 缓存之前的位置\n  const force = () => {\n    if (parentRef.current) {\n      const flipEles = getElementByFlipIdAll(parentRef.current);\n      const temp: { [key: string]: DOMRect } = {};\n      for (let i = 0; i < flipEles.length; i++) {\n\n        const flipEle = flipEles[i];\n        const { flipId } = (flipEle as HTMLElement).dataset;\n        if (flipId && flipEle) {\n          temp[flipId] = relativeRect(parentRef.current, flipEle as HTMLElement);\n        }\n      }\n      prevRectsRef.current = temp;\n    }\n  };\n\n  const handleLeave = (key: React.ReactText) => {\n    setChildren((prevChildren) => {\n      if (key in prevChildren) {\n        delete prevChildren[key];\n      }\n      return { ...prevChildren };\n    });\n  };\n\n  const mergeMap = (prev: ChildrenMap, next: ChildrenMap): ChildrenMap => {\n    prev = prev || {};\n    next = next || {};\n    function getValueForKey(key: React.ReactText) {\n      return key in next ? next[key] : prev[key];\n    }\n    let nextKeysPending = Object.create(null);\n    let pendingKeys = [];\n    for (let prevKey in prev) {\n      if (prevKey in next) {\n        if (pendingKeys.length) {\n          nextKeysPending[prevKey] = pendingKeys;\n          pendingKeys = [];\n        }\n      } else {\n        pendingKeys.push(prevKey);\n      }\n    }\n    let i;\n    let childMapping: ChildrenMap = {};\n    for (let nextKey in next) {\n      if (nextKeysPending[nextKey]) {\n        for (i = 0; i < nextKeysPending[nextKey].length; i++) {\n          let pendingNextKey = nextKeysPending[nextKey][i];\n          childMapping[pendingNextKey] = getValueForKey(\n            pendingNextKey\n          );\n        }\n      }\n      childMapping[nextKey] = getValueForKey(nextKey);\n    }\n    for (i = 0; i < pendingKeys.length; i++) {\n      childMapping[pendingKeys[i]] = getValueForKey(pendingKeys[i]);\n    }\n    return childMapping;\n  };\n\n  const getMap = (\n    children: React.ReactNode,\n    callback?: (child: React.ReactNode) => React.ReactNode\n  ): ChildrenMap => {\n    const map = Object.create(null);\n    if (children) {\n      // 如果没有手动添加key, React.Children.map会自动添加key\n      React.Children.map(children, c => c)?.forEach((child) => {\n        const key = (child as React.ReactElement).key || '';\n        if (key) {\n          if (React.isValidElement(child) && callback) {\n            map[key] = callback(child);\n          } else {\n            map[key] = child;\n          }\n        }\n      });\n    }\n    return map;\n  };\n\n  const initChildren = (\n    children: React.ReactNode,\n  ): ChildrenMap => {\n    return getMap(children, (child) => {\n      return React.cloneElement(child as React.ReactElement, {\n        _name: name,\n        _animation: true,\n        _onLeaveed: () => {\n          const key = (child as React.ReactElement).key || '';\n          handleLeave(key);\n        },\n      });\n    });\n  };\n\n  const nextChildren = (\n    nextChildren: React.ReactNode,\n    prevChildrenMap: ChildrenMap,\n  ): ChildrenMap => {\n    const nextChildrenMap = getMap(nextChildren);\n    const children = mergeMap(prevChildrenMap, nextChildrenMap);\n    Object.keys(children).forEach(key => {\n      const child = children[key];\n      if (!React.isValidElement(child)) {\n        return;\n      }\n      const hasKeyByNew = nextChildrenMap[key] !== undefined;\n      const hasKeyByPrev = prevChildrenMap[key] !== undefined;\n      const isNew = hasKeyByNew && !hasKeyByPrev;\n      const isDelete = !hasKeyByNew && hasKeyByPrev;\n      const isNeverChange = hasKeyByNew && hasKeyByPrev;\n      const prevProps = ((prevChildrenMap[key] as React.ReactElement)?.props as any);\n      if (isNew) {\n        children[key] = React.cloneElement(child, {\n          _name: name,\n          _animation: true,\n          _onLeaveed: () => {\n            const key = (child as React.ReactElement).key || '';\n            handleLeave(key);\n          },\n        });\n      } else if (isDelete) {\n        children[key] = React.cloneElement(child, {\n          _animation: false,\n        });\n      } else if (isNeverChange) {\n        children[key] = React.cloneElement(child, {\n          _animation: prevProps._animation,\n          _name: prevProps._name,\n          _onLeaveed: () => {\n            const key = (child as React.ReactElement).key || '';\n            handleLeave(key);\n          },\n        });\n      }\n    });\n    return children;\n  };\n\n  const [children, setChildren] = useState<ChildrenMap>(() => {\n    return initChildren(_children);\n  });\n\n  useEffect(() => {\n    if (!firstMount.current) {\n      setChildren(nextChildren(_children, children));\n    } else {\n      firstMount.current = false;\n    }\n  }, [_children]);\n\n  useLayoutEffect(() => {\n    console.log('useLayoutEffect')\n    const tasks = [];\n    if (parentRef.current && prevRectsRef.current) {\n      const flipEles = getElementByFlipIdAll(parentRef.current);\n      const moveClass = `${name}-move`;\n      const nextRects: {[key: string]: DOMRect} = {};\n      // 统一计算最新的样式\n      for (let i = 0; i < flipEles.length; i++) {\n        const flipEle = flipEles[i];\n        const { flipId } = (flipEle as HTMLElement).dataset;\n        if (flipId && flipEle) {\n          removeClass(flipEle as HTMLElement, moveClass);\n          nextRects[flipId] = relativeRect(parentRef.current, flipEle as HTMLElement);\n        }\n      }\n      // 计算之前样式与现在的样式的差，并设置样式\n      for (let i = 0; i < flipEles.length; i++) {\n        const flipEle = flipEles[i];\n        const { flipId } = (flipEle as HTMLElement).dataset;\n        if (flipId && flipEle) {\n          const nextRect = nextRects[flipId];\n          const prevRect = prevRectsRef.current[flipId];\n          let x = nextRect.x - prevRect.x;\n          let y = nextRect.y - prevRect.y;\n          if ((x !== 0 || y !== 0)) {\n            const s = (flipEle as HTMLElement).style;\n            s.transform = s.webkitTransform = `translate(${x}px,${y}px)`;\n            s.transitionDuration = '0s';\n            tasks.push(() => {\n              addClass(flipEle as HTMLElement, moveClass);\n              s.transform = s.webkitTransform = s.transitionDuration = '';\n              (flipEle as HTMLElement).addEventListener('transitionend', function cb (e) {\n                if (e && e.target !== flipEle) {\n                  return\n                }\n                if (!e || /transform$/.test(e.propertyName)) {\n                  (flipEle as HTMLElement).removeEventListener('transitionend', cb);\n                  // 删除move类\n                  removeClass(flipEle as HTMLElement, moveClass);\n                }\n              });\n            })\n          }\n        }\n      }\n      // 统一强制刷新\n      reflow();\n      // 统一开始动画\n      for (let i = 0; i < tasks.length; i++) {\n        const task = tasks[i];\n        task();\n      }\n    }\n  }, [children]);\n\n  const ChildNode = Object.values(children);\n\n  const WrapChildNode = React.createElement(wrap, {\n    className: wrapClass,\n    ref: parentRef,\n  }, ChildNode);\n\n  force();\n\n  return (\n    <>\n      { WrapChildNode }\n    </>\n  );\n}\n\nexport default React.memo(Flips);\n","// Thank you https://github.com/reactjs/react-transition-group/blob/master/src/utils/ChildMapping.js\nimport * as React from 'react';\nimport {\n  useState,\n  useRef,\n  useEffect,\n} from 'react';\nimport {\n  TransitionProps,\n} from './Transition';\n\ninterface ObserverProps {\n  wrap?: string;\n  wrapClass?: string;\n  children?: any;\n}\n\nexport type ChildrenMap = {\n  [key: string]: React.ReactNode\n};\n\nconst Observer: React.FC<ObserverProps> = (props) => {\n\n  const {\n    children: _children,\n    wrap = '',\n    wrapClass = '',\n  } = props;\n\n  const mergeMap = (prev: ChildrenMap, next: ChildrenMap): ChildrenMap => {\n    prev = prev || {};\n    next = next || {};\n    function getValueForKey(key: React.ReactText) {\n      return key in next ? next[key] : prev[key];\n    }\n    let nextKeysPending = Object.create(null);\n    let pendingKeys = [];\n    for (let prevKey in prev) {\n      if (prevKey in next) {\n        if (pendingKeys.length) {\n          nextKeysPending[prevKey] = pendingKeys;\n          pendingKeys = [];\n        }\n      } else {\n        pendingKeys.push(prevKey);\n      }\n    }\n    let i;\n    let childMapping: ChildrenMap = {};\n    for (let nextKey in next) {\n      if (nextKeysPending[nextKey]) {\n        for (i = 0; i < nextKeysPending[nextKey].length; i++) {\n          let pendingNextKey = nextKeysPending[nextKey][i];\n          childMapping[pendingNextKey] = getValueForKey(\n            pendingNextKey\n          );\n        }\n      }\n      childMapping[nextKey] = getValueForKey(nextKey);\n    }\n    for (i = 0; i < pendingKeys.length; i++) {\n      childMapping[pendingKeys[i]] = getValueForKey(pendingKeys[i]);\n    }\n    return childMapping;\n  };\n\n  const getMap = (\n    children: React.ReactNode,\n    callback?: (child: React.ReactNode) => React.ReactNode\n  ): ChildrenMap => {\n    const map = Object.create(null);\n    if (children) {\n      // 如果没有手动添加key, React.Children.map会自动添加key\n      React.Children.map(children, c => c)?.forEach((child) => {\n        const key = (child as React.ReactElement).key || '';\n        if (key) {\n          if (React.isValidElement(child) && callback) {\n            map[key] = callback(child);\n          } else {\n            map[key] = child;\n          }\n        }\n      });\n    }\n    return map;\n  };\n\n  const initChildren = (\n    children: React.ReactNode,\n  ): ChildrenMap => {\n    return getMap(children, (child) => {\n      return React.cloneElement(child as React.ReactElement, {\n        animation: true,\n        _onLeaveed: () => {\n          const key = (child as React.ReactElement).key || '';\n          handleLeave(key);\n        },\n      });\n    });\n  };\n\n  const nextChildren = (\n    nextChildren: React.ReactNode,\n    prevChildrenMap: ChildrenMap,\n  ): ChildrenMap => {\n    const nextChildrenMap = getMap(nextChildren);\n    const children = mergeMap(prevChildrenMap, nextChildrenMap);\n    Object.keys(children).forEach(key => {\n      const child = children[key];\n      if (!React.isValidElement(child)) {\n        return;\n      }\n      const hasKeyByNew = nextChildrenMap[key] !== undefined;\n      const hasKeyByPrev = prevChildrenMap[key] !== undefined;\n      const isNew = hasKeyByNew && !hasKeyByPrev;\n      const isDelete = !hasKeyByNew && hasKeyByPrev;\n      const isNeverChange = hasKeyByNew && hasKeyByPrev;\n      const prevProps = ((prevChildrenMap[key] as React.ReactElement)?.props as TransitionProps);\n      if (isNew) {\n        children[key] = React.cloneElement(child, {\n          animation: true,\n          _onLeaveed: () => {\n            const key = (child as React.ReactElement).key || '';\n            handleLeave(key);\n          },\n        });\n      } else if (isDelete) {\n        children[key] = React.cloneElement(child, {\n          animation: false,\n        });\n      } else if (isNeverChange) {\n        children[key] = React.cloneElement(child, {\n          animation: prevProps.animation,\n          _onLeaveed: () => {\n            const key = (child as React.ReactElement).key || '';\n            handleLeave(key);\n          },\n        });\n      }\n    });\n    return children;\n  };\n\n  const handleLeave = (key: React.ReactText) => {\n    setChildren((prevChildren) => {\n      if (key in prevChildren) {\n        delete prevChildren[key];\n      }\n      return { ...prevChildren };\n    });\n  };\n\n  const firstMount = useRef<boolean>(true);\n  const [children, setChildren] = useState<ChildrenMap>(() => {\n    return initChildren(_children);\n  });\n\n  useEffect(() => {\n    if (!firstMount.current) {\n      setChildren(nextChildren(_children, children));\n    }\n    firstMount.current = false;\n  }, [_children]);\n\n  const ChildNode = Object.values(children);\n\n  if (wrap) {\n    const WrapChildNode = React.createElement(wrap, {\n      className: wrapClass,\n    }, ChildNode);\n\n    return (\n      <>\n        { WrapChildNode }\n      </>\n    );\n  }\n\n  return (\n    <>\n      { ChildNode }\n    </>\n  );\n}\n\nexport default Observer;\n"],"sourceRoot":""}